{
  "_from": "kijiji-scraper",
  "_id": "kijiji-scraper@5.0.3",
  "_inBundle": false,
  "_integrity": "sha512-jggFP47o6xXEnrGk0CDctPLf4yn5bIsooAxenb5wyzuQwuxFAeASJd6appjm4HLe/5SMtSW7eiFZ7JHfjBS8XA==",
  "_location": "/kijiji-scraper",
  "_phantomChildren": {},
  "_requested": {
    "escapedName": "kijiji-scraper",
    "fetchSpec": "latest",
    "name": "kijiji-scraper",
    "raw": "kijiji-scraper",
    "rawSpec": "",
    "registry": true,
    "saveSpec": null,
    "type": "tag"
  },
  "_requiredBy": [
    "#USER"
  ],
  "_resolved": "https://registry.npmjs.org/kijiji-scraper/-/kijiji-scraper-5.0.3.tgz",
  "_shasum": "29086948c6b9c6726bfe8eb988a25f4dd755cb0b",
  "_spec": "kijiji-scraper",
  "_where": "D:\\NewComputerDocuments\\Sturents-Jake-Branch\\Sturents\\NodeScraper",
  "author": {
    "name": "Matt Penny"
  },
  "bugs": {
    "url": "https://github.com/mwpenny/kijiji-scraper/issues"
  },
  "bundleDependencies": false,
  "dependencies": {
    "cheerio": "^0.22.0",
    "node-fetch": "~2.2.0"
  },
  "deprecated": false,
  "description": "A scraper for Kijiji ads",
  "devDependencies": {},
  "homepage": "https://github.com/mwpenny/kijiji-scraper#readme",
  "keywords": [
    "kijiji",
    "scraper"
  ],
  "license": "MIT",
  "main": "index.js",
  "name": "kijiji-scraper",
  "optionalDependencies": {},
  "readme": "# kijiji-scraper\nA lightweight node.js module for retrieving and scraping ads from [Kijiji](http://www.kijiji.ca).\n\n\n## Features\n* Retrieve single ads as JavaScript objects given their URL\n* Retrieve the latest ads matching given search criteria\n\n## Dependencies\n* [node.js](http://github.com/joyent/node) - evented I/O for the backend\n* [cheerio](http://www.github.com/cheeriojs/cheerio) - jQuery-like API for the server\n* [node-fetch](https://github.com/bitinn/node-fetch) - [Fetch](https://fetch.spec.whatwg.org) API implementation for Node.Js\n\n## Installation\n`npm install kijiji-scraper`\n\n## Documentation\n\n**Quick start:** Use `Ad.Get()` to scrape an ad given its URL. Use `search()` to scrape many ads given a set of search parameters. Read on (or CTRL+F) for more detailed information.\n\n### `Ad` class\nThis class encapsulates a Kijiji ad and its properties. It also handles retrieving this information from Kijiji.\n\n#### Properties\n|Property      |Type    |Description                                          |\n|--------------|--------|-----------------------------------------------------|\n|`title`       |String  |Title of the ad                                      |\n|`description` |String  |Ad description                                       |\n|`date`        |Date    |Date the ad was posted                               |\n|`image`       |String  |URL of the ad's primary image                        |\n|`images`      |String[]|Array of URLs of the ad's images                     |\n|`attributes`  |Object  |Properties specific to the category of the scraped ad|\n|`url`         |String  |The ad's url                                         |\n\nThe image URL given in `image` is the featured image for the ad and will be up to 300x300. The image URLs given in `images` are all of the images associated with the ad and each may be up to 1024x1024.\n\n**Note:** If the ad has not been scraped automatically, some of these properties may be null or empty. This happens when an `Ad` object is created manually using the constructor or by performing a search with the `scrapeResultDetails` option set to `false`. See the `Ad.isScraped()` and `Ad.scrape()` method documentation below for more information on this.\n\n#### Methods\n\n##### `Ad.Get(url[, callback])`\n\nWill scrape the Kijiji ad at `url` and construct an `Ad` object containing its information.\n\n###### Arguments\n\n* `url` - A Kijiji ad URL\n* `callback(err, ad)` (optional) - A callback called after the ad has been scraped. If an error occurs during scraping, `err` will not be null. If everything is successful, `ad` will contain an `Ad` object\n\n###### Return value\n\nReturns a `Promise` which resolves to an `Ad` object containing the ad's information.\n\n###### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\n// Scrape using returned promise\nkijiji.Ad.Get(\"<Kijiji ad URL>\").then(function(ad) {\n    // Use the ad object\n    console.log(ad.title);\n}).catch(console.error);\n\n// Scrape using optional callback paramater\nkijiji.Ad.Get(\"<Kijiji ad URL>\", function(err, ad) {\n    if (!err) {\n        // Use the ad object\n        console.log(ad.title);\n    }\n});\n```\n\n##### `Ad(url[, info, scraped])`\n\n`Ad` constructor. Manually constructs an ad object. You should generally not need to use this save for a few special cases (e.g., storing ad URLs entered by a user for delayed scraping). `Ad.isScraped()` returns false for `Ad` objects constructed in this way unless `scraped` is passed as `true` or they are subsequently scraped by calling `Ad.scrape()`, which causes the scraper to replace the ad's information with what is found at its URL.\n\n###### Arguments\n\n* `url` - Ad's URL\n* `info` (optional) - Object containing the ad's properties. Only keys in the properties table (above) may be specified. May be omitted (if not specified then `images` will be an empty array, `attributes` will be an empty object, and all other properties will be null)\n* `scraped` (optional) - If `true`, causes `Ad.IsScraped()` to return `true` regardless of whether or not `Ad.scrape()` has been called\n\n###### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\nlet ad = kijiji.Ad(\"<Kijiji ad URL>\", { date: new Date() });\nconsole.log(ad.isScraped()); // false\nconsole.log(ad.date); // current date\n\nad.scrape().then(function() {\n    // Use the ad object\n    console.log(ad.date); // date ad was posted (initial value is overwritten)\n}).catch(console.error);\n```\n\n##### `Ad.isScraped()`\n\nDetermines whether or not the ad's information has been retrieved from Kijiji.\n\n###### Return value\n\nReturns a boolean indicating whether or not an ad's information has been scraped from the page at its URL. This can be false if the `Ad` object was manually created using the constructor or if it was retrieved from a search with the `scrapeResultDetails` option set to false. Call `Ad.scrape()` to retrieve the information for such ads.\n\n###### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\nlet ad = kijiji.Ad(\"<Kijiji ad URL>\");  // ad does not get scraped\nconsole.log(ad.isScraped()); // false\n\nad.scrape().then(function() {\n    console.log(ad.isScraped()); // true\n}).catch(console.error);\n```\n\n##### `Ad.scrape([callback])`\n\nManually retrieves an `Ad`'s information from its URL. Useful if it was created in a way that does not do this automatically, such as using the constructor or performing a search with the `scrapeResultDetails` option set to false.\n\n###### Arguments\n\n* `callback(err)` (optional) - A callback called after the ad has been scraped. If an error occurs during scraping, `err` will not be null\n\n###### Return value\n\nReturns a `Promise` which resolves once the ad has been scraped and the object has been updated.\n\n###### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\nlet ad = kijiji.Ad(\"<Kijiji ad URL>\");  // ad does not get scraped\nconsole.log(ad.isScraped()); // false\n\n// Scrape using returned promise\nad.scrape().then(function() {\n    // Use the ad object\n    console.log(ad.isScraped()); // true\n    console.log(ad.title);\n}).catch(console.error);\n\n// Scrape using optional callback paramater\nad.scrape(function(err) {\n    if (!err) {\n        // Use the ad object\n        console.log(ad.isScraped()); // true\n        console.log(ad.title);\n    }\n});\n```\n\n##### `Ad.toString()`\n\nReturns a string representation of the ad. This is just meant to be a summary and may omit information for brevity or change format in the future. Access the `Ad`'s properties directly if you need them for comparisons, etc. The current format is as follows:\n```\n[MM/dd/yyyy @ hh:mm] TITLE\nURL\n* property1: value1\n* property2: value2\n...\n* propertyN: valueN\n```\nThe date, title, and properties will be absent if the ad has not been scraped (`isScraped() == false`) unless they were manually specified when the object was constructed.\n\n###### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\nkijiji.Ad.Get(\"<Kijiji ad URL>\").then(function(ad) {\n    console.log(ad.toString());\n}).catch(console.error);\n```\n\n---\n### Searching for ads\n\nSearches are performed using the `search()` function:\n\n#### search(params[, options, callback])\n\n##### Arguments\n* `params` - Object containing Kijiji ad search parameters.\n    * **Mandatory parameters:**\n\n        |Parameter   |Type          |Default Value       |Description                                                     |\n        |------------|--------------|--------------------|----------------------------------------------------------------|\n        |`locationId`|Integer/Object|`0` (all of Canada) |Id of the geographical location to search in                       |\n        |`categoryId`|Integer/Object|`0` (all categories)|Id of the ad category to search in                                 |\n\n        Values for `locationId` and `categoryId` can be found by performing a search on the Kijiji website and examining the URL that Kijiji redirects to. For example, after setting the location to Ottawa and selecting the \"cars & vehicles\" category, Kijiji redirects to http://www.kijiji.ca/b-cars-vehicles/ottawa/c27l1700185. The last part of the URL (c27l1700185) is formatted as c[categoryId]l[locationId]. So in this case, `categoryId` is 27 and `locationId` is 1700185.\n\n        ###### Location and category objects\n        For convenience, objects containing all `locationId` and `categoryId` values Kijiji accepts have been defined in `locations.js` and `categories.js`, respectively. These objects are nested in the same way as those in the location and category selectors on the Kijiji website (e.g., the city of Montreal is located under \"Quebec > Greater Montreal > City of Montreal\"; coffee tables are located under \"Buy and Sell > Furniture > Coffee Tables\"), so their contents should be familiar.\n\n        For example, instead of setting `locationId` to `1700281` (Montreal) and `categoryId` to `241` (coffee tables), you can set `locationId` to `locations.QUEBEC.GREATER_MONTREAL.CITY_OF_MONTREAL` and `categoryId` to `categories.BUY_AND_SELL.FURNITURE.COFFEE_TABLES`. You no longer need to know the ids, and you have a quick reference available. Any location/category object along the hierarchy will also work (e.g., `locations.QUEBEC` for all of Quebec, not just Montreal; `categories.BUY_AND_SELL.FURNITURE` for all furniture, not just coffee tables). Location/category objects and `locationId`s/`categoryId`s are interchangeable - the search function will behave identically in either case. See `locations.js` and `categories.js` for all location and category objects.\n\n    * **Optional parameters:**\n        There are many different search parameters. Some of these can be used in any search (i.e., `keywords`), but most are category-specific. Parameters can be found by using your browser's developer tools and performing a custom search on the Kijiji website. After submitting your search on Kijiji or updating the filter being applied, use your browser's network monitoring tool to examine the request for `https://www.kijiji.ca/b-search.html`. Any parameter used in the query string for this request is able to be specified in `params`. A few examples include:\n\n        |Parameter   |Type  |Description                                                                   |\n        |------------|------|------------------------------------------------------------------------------|\n        |`keywords`  |String|Search string, with words separated by a '+'                                  |\n        |`minPrice`  |Number|Minimum price of returned items                                               |\n        |`maxPrice`  |Number|Maximum price of returned items                                               |\n        |`adType`    |String|Type of add (\"OFFER\", \"WANTED\", or undefined - for both)                      |\n        |`sortByName`|String|Search results ordering (e.g., \"dateDesc\", \"dateAsc\", \"priceDesc\", \"priceAsc\")|\n\n* `options` (optional) - Contains parameters that control the behavior of the scraper. Can be omitted.\n\n    |Option               |Type   |Default Value|Description|\n    |---------------------|-------|-------------|-----------|\n    |`scrapeResultDetails`|Boolean|`true`      |By default, the details of each query result are scraped in separate, subsequent requests. To suppress this behavior and return only the data retrieved by the initial query, set this option to `false`. Note that ads will lack some information if you do this and `Ad.isScraped()` will return `false` until `Ad.scrape()` is called to retrieve the missing information.|\n    |`minResults`         |Integer|`20`         |Minimum number of ads to fetch (if available). Note that Kijiji results are returned in pages of up to 20 ads, so if you set this to something like 29, up to 40 results may be retrieved.|\n    |`maxResults`         |Integer|`-1`         |Maximum number of ads to return. This simply removes excess results from the array that is returned (i.e., if `minResults` is 40 and `maxResults` is 7, 40 results will be fetched from Kijiji and the last 33 will be discarded). A negative value indicates no limit.|\n\n* `callback(err, results)` (optional) - A callback called after the search results have been scraped. If an error occurs during scraping, `err` will not be null. If everything is successful, `results` will contain an array of `Ad` objects.\n\n###### Return value\n\nReturns a `Promise` which resolves to an array of search result `Ad` objects.\n\n##### Example usage\n```js\nconst kijiji = require(\"kijiji-scraper\");\n\nlet options = {\n    minResults: 40\n};\n\nlet params = {\n    locationId: 1700185,  // Same as kijiji.locations.ONTARIO.OTTAWA_GATINEAU_AREA.OTTAWA\n    categoryId: 27,  // Same as kijiji.categories.CARS_AND_VEHICLES\n    sortByName: \"priceAsc\"  // Show the cheapest listings first\n};\n\n// Scrape using returned promise\nkijiji.search(params, options).then(function(ads) {\n    // Use the ads array\n    for (let i = 0; i < ads.length; ++i) {\n        console.log(ads[i].title);\n    }\n}).catch(console.error);\n\n// Scrape using optional callback parameter\nfunction callback(err, ads) {\n    if (!err) {\n        // Use the ads array\n        for (let i = 0; i < ads.length; ++i) {\n            console.log(ads[i].title);\n        }\n    }\n}\nkijiji.search(params, options, callback);\n```\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git://github.com/mwpenny/kijiji-scraper.git"
  },
  "scripts": {},
  "version": "5.0.3"
}
